# Changelog

All notable changes to this project will be documented in this file. See [standard-version](https://github.com/conventional-changelog/standard-version) for commit guidelines.

## [1.2.0](https://github.com/mWorkTime/server/compare/v1.1.0...v1.2.0) (2020-10-29)


### Features

* **server:** enhance logic in department, auth, employee - services. Add field 'roles' to verify-token-from-req. Add department.validator. Enhance department.route - add validator to the route 'create'. ([671845d](https://github.com/mWorkTime/server/commit/671845da5f6f3ef4cfbc0cea0430778210958014))
* **server: auth, employee:** refactor organization.model - remove fields owner and employees. Refactor auth.service and add to auth.controller new field 'orgName'. Refactor getEmployeesByOrgCode in employee.service. ([45802bf](https://github.com/mWorkTime/server/commit/45802bfa871c27416053601160adb5b57144b93a))
* **server: department:** add department route, controller, service. Add the route to server (index.js). Add routes for get all departments and create new department to the route. ([d06414a](https://github.com/mWorkTime/server/commit/d06414af19248d8333002157becdc7928877daa8))
* **server: Department:** add department model. Enhance user model - add default value to field 'gender', add new field 'department'. Add department to registration new user. ([48e140c](https://github.com/mWorkTime/server/commit/48e140cfcec5e199efd8f1cc4340cb93fdccc5f5))
* **server: dismiss employee:** add the ability to dismiss employees from the organization. Add dismiss employee - route, controller and service. Some changes in auth.service. ([7d207d1](https://github.com/mWorkTime/server/commit/7d207d193914a9a22826cc09645aae53f9d3a8bd))
* **server: email:** add email template - registration-employee. Add new logic (send mail to employee) to employee.service. Add new styles and blocks to registration (mail template). ([1ca5ba2](https://github.com/mWorkTime/server/commit/1ca5ba29b88fdf7e9fc2c475f8b4ea3ba1c3074e))
* **server: email:** change config in email-transporter. Refactor - email templates. ([775b5db](https://github.com/mWorkTime/server/commit/775b5db52615e9b70a3a44167b4b78b9c1625148))
* **server: employee:** add an employee - controller, service, route, validator. Add the route to server. Add new routes to the route. Add function 'saveNewEmployee' - to the service. ([28518eb](https://github.com/mWorkTime/server/commit/28518eb0834d404c668afab22d275e5abf477203))
* **server: employee:** use lib debug in server. Add utils - remove-whitespace and sanitize-phone-number. Add some logic and function to employee.controller. Add getEmployeesByOrgCode to employee.service. ([cc5c6ae](https://github.com/mWorkTime/server/commit/cc5c6ae2c90fc739d272e1d9ed6ba6de17148947))
* **server: get employee:** add to employee controller - getEmloyee, to the service - getEmployeeById. Add to the route - a route get employee by id. ([65777df](https://github.com/mWorkTime/server/commit/65777df52f2211ba1372e960871b93f77de20c16))
* **server: middlewares:** add new middlewares - organization and permission. ([b9f36d9](https://github.com/mWorkTime/server/commit/b9f36d90d6e1090eb9ffb3764493553cfde87c5d))
* **server: role:** add department - route, controller, service. Add getRolesFromDB to role.service. Add transform-array to utils. ([10745a0](https://github.com/mWorkTime/server/commit/10745a038f57f8fa92bdd952b38367812780dceb))
* **server: user:** improve models - department, user, organization --> remove unnecessary fields 'username','code','code-department'. Change logic in auth.service, user.service and verify-token-from-req. ([d846725](https://github.com/mWorkTime/server/commit/d846725f306ccbcbba35ad30bdb3f3aba0f7edcc))
* **web: employee-edit:** Add items for form employee-edit to formCreateItems. Add updateEmployee (local) - to employee.reducer. Some changes in employee-forms and user modal. ([b43cc22](https://github.com/mWorkTime/server/commit/b43cc22c9527f9efbe97630c3deea5aa7c25f8a3))

## 1.1.0 (2020-10-21)


### Features

* **auth:** add logout to auth.service. Add field 'redirectToMain' to user reducer. Add action clearUserData to types, reducer, action. Add function for logout from app to dashboard. Add axios interceptor for request (make all request with header authorization) ([2b8876f](https://github.com/mWorkTime/server/commit/2b8876fc8d6fb4a0fe450444105da77f22c41625))
* **enhance auth:** add field isVerified to user.model - for confirm user account. Add package nodemailer. Using the package for sending letter with link for confirm email address and account. Add folder emails. Add dictionary for collect some messages. Add token.model. The token that is sent to user for confirm his email address. ([7c3d688](https://github.com/mWorkTime/server/commit/7c3d68807ef3c8c97f65b166fb17a542a93dbf30))
* **enhance auth:** Improve auth.controller, most of the logic from the login and register functions has been moved to auth.service. Add sending an email to the user in the saveNewUserAndOrganization function. Add the getUserAndLogin function to the auth.service. ([ce6eebe](https://github.com/mWorkTime/server/commit/ce6eebeea917b0a949f3f5462e01bf678a4e3794))
* **initial app:** add necessary packages to web - antd, react-redux, redux, react-router; server - mongoose, shortid, jsonwebtoken, express-validator, express-jwt, express, dotenv, debug, cookie-parser, body-parser. Add - readme, license. ([cba7260](https://github.com/mWorkTime/server/commit/cba72604526ef8ec92b2f89005660fa5a4dd117a))
* **readme:** update README.md in server and web. ([5dae57f](https://github.com/mWorkTime/server/commit/5dae57fb1311b4cd5f86ebe8b58d1398ff88d08a))
* **refresh token:** server - add route '/auth/refresh', add refreshToken to auth.controller and to auth.service. Add model blocklist. Web - add an automatic token update when the response status is 401, and a store update to axios-app.js. ([99a8de1](https://github.com/mWorkTime/server/commit/99a8de15d72187469b97285b2b8df461e69da38d))
* **resend link:** add resend component. Add function resendConfirmLink to confirm.service. Add the resend to login component. Server: add - route resend; resend-link validator for email. ([9d23348](https://github.com/mWorkTime/server/commit/9d23348b04b4cce8e839d844e9b63313c5d65ad8))
* **server: auth:** Change logic for registration new user using the roles. Remove 'try catch' from 'register' in auth.controller. Use 'try catch' for catching error in auth.service. ([2127e1d](https://github.com/mWorkTime/server/commit/2127e1d1d0075af9caa1faa5b3a4807599f5b389))
* **server: confirm:** change logic for confirmation user account and for resend confirm link. ([1a6b089](https://github.com/mWorkTime/server/commit/1a6b0899f5953b8284c4f6cd2742a1a2efd388fd))
* **server: role:** add model role with fields - 'name' and 'role-code'. Add folder 'seed'. Add generate-roles to the folder. Add folder 'tests'. Add test-route to the folder. ([d526fbd](https://github.com/mWorkTime/server/commit/d526fbd8a37d50c07d948822cd52db64f94bf772))
* **server: user:** add fields - 'gender', 'surname' to model user and change type role in the model. Add user check to the service ([a239ac9](https://github.com/mWorkTime/server/commit/a239ac9f260ad4c94e05e4d2cfaecbcb2d168487))
* **server: user:** add user - route, controller, service. Using the route by server. ([536efea](https://github.com/mWorkTime/server/commit/536efea7d49a99045de93ccbcef4d050f4fa325f))
* **sidebar:** add sidebar - component, action, reducer. Add burger component. Add styles for dashboard, sidebar, burger. Add routes - for authorized and unauthorized users. ([ac01043](https://github.com/mWorkTime/server/commit/ac010436c14a95bed9d3987c8a039ae410509bcb))
* **user, dashboard:** server - add timestamps to model, remove cookie from auth service. Web - add folder items with dashboard, sidebar data. Add headers to user service. Add to sidebar new action 'showSidebar'. Add dashboard folder to components/user.  Add user-dashboard and user dashboard-top to the dashboard. Add loader to the user-dashboard.js when data is loading. ([73e0ef6](https://github.com/mWorkTime/server/commit/73e0ef628c9f7ddb1d7daf237c683bfbe3d6d739))
* **web: enhance auth forms, server: token, services:** add clear all fields to auth forms. Add clear all messages in login and register page. Add messages that are came from confirm component. Add to token model some fields. Add to email registration - styles. ([cc8a1c5](https://github.com/mWorkTime/server/commit/cc8a1c530e335b5927b38575ce704e84bded96b8))
* **web: token:** add field 'token' to user reducer. Add redirect to dashboard page from login using hook useHistory. Remove cookie. Add token to localStorage. Add type and action setAuthToken. ([6687d14](https://github.com/mWorkTime/server/commit/6687d147b453f41cfa512e2e6101d4b6ca526e54))
* **working authorization:** add route '/login' with middleware for validation data to auth.route. Add to auth.validator - new rules for validation data when user is trying to login. Add function login to auth.controller - check user and returned response with some data or error message. ([3690d87](https://github.com/mWorkTime/server/commit/3690d87b53bbbdbff70bccba4b7b955c785cc6c6))
* **working confirm email address:** add confirm - route, service, controller. Add the route to server. Add to the route  - post request('/email'). Add functions confirmEmail, resendLink - to the controller. Add functions verifyEmail, generateAndSaveNewConfirmLink - to the service. Add util for decoded token and return some data from this. ([7344237](https://github.com/mWorkTime/server/commit/73442371765ae04bbe0344b866270de16872a0b3))
* **working logout:** add middleware to check and verify the token. Add route '/logout' with the middleware to auth.route. Add function logout to auth.controller. ([4cb9c48](https://github.com/mWorkTime/server/commit/4cb9c48bd56c3652ab4f27a5d0ac040f9f36355a))
* **working registration:** add auth - controller, route, service, validator. Add middleware - run-validation. Add model - organization and user. Add route '/register'. Add function register to the controller. Add function saveNewUserAndOrganization to the service. ([7b51115](https://github.com/mWorkTime/server/commit/7b51115ba33822caa073c83901f08d6b162c6a4a))
